/**
 * Типы для структуры документации (md/mdx).
 *
 * Где используются:
 *  - Роуты: /api/docs/tree, /api/docs/entries
 *  - Сервисы: services/docs/* (дерево, чтение каталогов, метаданные)
 *
 * Назначение:
 *  - DocNode — единица дерева: либо директория, либо файл.
 *  - DirInfo — метаданные текущей директории (для шапки/навигации).
 */

/** Узел дерева документов (папка или файл). */
export type DocNode = {
	/**
	 * Тип файла: private или public
	 */
	kind: string
	/**
	 * Реальное имя в файловой системе:
	 * - для директории: последний сегмент пути
	 * - для файла: имя без расширения (например, "setup", "index")
	 */
	name: string

	/**
	 * Реальный относительный путь от DOCS_ROOT в POSIX-виде (только /):
	 * - директория: "guides/getting-started"
	 * - файл: путь БЕЗ расширения — "guides/setup" или "guides/getting-started/index"
	 *
	 * Этот путь используется фронтендом для построения ссылок.
	 */
	path: string

	/** Имя папки в транслит. формате */
	slug?: string

	/** Transliteration-safe path relative to the docs root. */
	slugPath?: string

	/** true — директория, false — md/mdx-файл. Удобно для условного рендера в UI. */
	isDirectory: boolean

	/**
	 * Заголовок из frontmatter:
	 * - для директории — берётся из index.mdx (если есть)
	 * - для файла — из самого файла
	 * Если отсутствует, UI обычно показывает name.
	 */
	title?: string

	/** Только для директорий: есть ли index.{md,mdx} внутри (страница раздела). */
	hasIndex?: boolean

	/**
	 * Только для директорий: есть ли «видимые» элементы внутри (подпапки или md/mdx-файлы),
	 * с учётом фильтров (скрытые/системные исключены). Нужен для каретки/раскрытия.
	 */
	hasChildren?: boolean

	/**
	 * Дочерние узлы (если дерево строилось рекурсивно через /tree?full=1).
	 * Для /entries (нерекурсивно) обычно не заполняется.
	 */
	children?: DocNode[]

	visibility?: 'public' | 'private'
}

/** Метаданные текущей директории (возвращаются вместе со списком entries). */
export type DirInfo = {
	/** Реальное имя папки (как в файловой системе, последний сегмент). */
	name: string
	/** Реальный относительный путь от DOCS_ROOT (POSIX). */
	path: string
	/** Заголовок из frontmatter index.mdx (если есть). */
	title?: string
	/** Есть ли index.mdx в текущей папке. */
	hasIndex: boolean
	/** Есть ли «видимые» подпапки/файлы внутри папки. */
	hasChildren: boolean
}
